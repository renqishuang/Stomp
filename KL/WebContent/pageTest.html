<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>WebSocket功能测试</title>
<style>
</style>
<script src='js/jquery.1.11.3.min.js'></script>
</head>
<body>
<script src='js_test/ws.js'></script>
<script>
	window.WebSocketConnectState = false;
	var url='ws://mq1.zlw.com:61634';
	function success(client){
		WebSocketConnectState = true;
		console.log('success');
		if(CurrentWSClient == null){
			CurrentWSClient = client;
			clearInterval(AgainConnectWS);
		}
	}
	function fail(){
		console.log('fail');
	}
	function message(){
		console.log('message');
	}
	function close(){
		WebSocketConnectState =false;
		console.log('close');
		//进行重新连接
		window.AgainConnectWS = setInterval(function(){
			if(WebSocketConnectState == true) return;
			CurrentWSClient = null;
			var client = WSClient.connect(url,success,fail,message,close);
		},1000);
	}
	window.CurrentWSClient = WSClient.connect(url,success,fail,message,close);
</script>
</body>
</html>