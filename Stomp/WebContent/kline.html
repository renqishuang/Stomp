<!doctype html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <title>k line painter   K线图 滑块控制</title>
    <script src='js/jquery.1.11.3.min.js'></script>
    <script src="js/stomp.js"></script>
    <script src='js/constants.js'></script>
    <script src='js/commonTool.js'></script>
    <script src='js/klineStore.js'></script>
    <script src="libs/loading.js" ></script>
    <script src="libs/util.js" ></script>
    <script src="libs/absPainter.js" ></script>
    <script src="libs/ajax.js"  ></script>
    <script src="libs/crossLines.js"  ></script>
    <script src="libs/axis-x.js"  ></script>
    <script src="libs/tip.js"  ></script>
    <script src="libs/linepainter.js"  ></script>
    <script src="libs/volumePainter.js"  ></script>
    <script src="libs/axis-y.js"  ></script>
    <script src="libs/chartEventHelper.js?abc"  ></script>
    <script src="libs/controller.js" ></script>
    <script src="js/testInitData.js"></script>
    <script src='js/k_line.js'></script>
    <script>
    	function getKLDt(){
    		var type = 1;
    		var rd = parseInt(Math.random()*10);
    		var dt = [{"close":"2981.6","closechg":"-5.2","open":"2981.6","openchg":"-5.2","high":"2981.6","highchg":-1,"low":"2981.6","lowchg":-1,"datetime":1455845400000,"volume":-14278,"volumechg":-14393,"openinterest":29234,"openinterestchg":-41,"pricechg":"-5.2","pricechgrate":"-0.17%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.2","closechg":"-6.6","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14273,"volumechg":-14388,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.6","pricechgrate":"-0.22%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.4","closechg":"-6.4","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14271,"volumechg":-14386,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.4","pricechgrate":"-0.21%","datatype":"1","timeremain":58000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2981.6","closechg":"-5.2","open":"2976.6","openchg":"-5.2","high":"2982.6","highchg":-1,"low":"2972.6","lowchg":-1,"datetime":1455845400000,"volume":-14278,"volumechg":-14393,"openinterest":29234,"openinterestchg":-41,"pricechg":"-5.2","pricechgrate":"-0.17%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.2","closechg":"-6.6","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14273,"volumechg":-14388,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.6","pricechgrate":"-0.22%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.4","closechg":"-6.4","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14271,"volumechg":-14386,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.4","pricechgrate":"-0.21%","datatype":"1","timeremain":58000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2981.6","closechg":"-5.2","open":"2976.6","openchg":"-5.2","high":"2982.6","highchg":-1,"low":"2972.6","lowchg":-1,"datetime":1455845400000,"volume":-14278,"volumechg":-14393,"openinterest":29234,"openinterestchg":-41,"pricechg":"-5.2","pricechgrate":"-0.17%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.2","closechg":"-6.6","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14273,"volumechg":-14388,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.6","pricechgrate":"-0.22%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.4","closechg":"-6.4","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14271,"volumechg":-14386,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.4","pricechgrate":"-0.21%","datatype":"1","timeremain":58000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2981.6","closechg":"-5.2","open":"2976.6","openchg":"-5.2","high":"2982.6","highchg":-1,"low":"2972.6","lowchg":-1,"datetime":1455845400000,"volume":-14278,"volumechg":-14393,"openinterest":29234,"openinterestchg":-41,"pricechg":"-5.2","pricechgrate":"-0.17%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.2","closechg":"-6.6","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14273,"volumechg":-14388,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.6","pricechgrate":"-0.22%","datatype":"1","timeremain":59000,"tradingday":1455811200000,"iid":"IF1603","interval":60},
    		          {"close":"2975.4","closechg":"-6.4","open":"2976.6","openchg":"-5.2","high":"2976.6","highchg":-1,"low":"2975.2","lowchg":-1,"datetime":1455845400000,"volume":-14271,"volumechg":-14386,"openinterest":29233,"openinterestchg":-42,"pricechg":"-6.4","pricechgrate":"-0.21%","datatype":"1","timeremain":58000,"tradingday":1455811200000,"iid":"IF1603","interval":60}];
    		var dt = dt[rd];
    		var time=dt.datetime;
    		var date = new Date(time);
    		var dateNumber = converDateStrByDate(date);
    		var open,high,low,close,volume,amount=2939,preClose=2985.8;
    		if(type == 0){//整数
    			open  = parseInt(dt.open);
        		high = parseInt(dt.high);
        		low = parseInt(dt.low);
        		close = parseInt(dt.close);
        		volume = parseInt(dt.volume);
    		}else if(type == 1){//小数点后一位
    			open  = parseFloat(dt.open);
        		high = parseFloat(dt.high);
        		low = parseFloat(dt.low);
        		close = parseFloat(dt.close);
        		volume = parseFloat(dt.volume);
    		}
    		var item = {
    			quoteTime:dateNumber,
    			open:open,
    			high:high,
    			low:low,
    			close:close,
    			volume:volume,
    			amount:amount,
    			preClose:preClose
    		};
    		return item;
    	}
    	function startSubscribe(){
    		//CurrentKLObj.addCandleToKL(getKLDt());//添加一个K线
 			CurrentKLObj.updateKLOnCandle(getKLDt());//更新一个K线
 			/* var closeTip = new CloseTip({
 				position:{x:1,y:2},
 				width:200,
 				height:100
 			});
 			console.log(closeTip); */
    	}
    	function stopSubscribe(){
    		CurrentKLObj.addCandleToKL(getKLDt());//添加一个K线
    		drawKL();
    	}
    	function initKLData(){
    		originalDataHandle(InitTestDataOne);
    	}
    	function initHandler(){
    		initKLData();
    		drawKL();
    	}
    </script>
</head>
<body onload="initHandler()" style="padding:0;margin:2px">
    <canvas id="canvasKL" width="1002" height="460" style="z-index: 2; border: 1px solid #69c">
        <p>hey,您的浏览器不支持html5，换个浏览器吧，比如google chrome，firefox</p>
    </canvas>
    <div id="debug"></div>
    <button onclick="startSubscribe();">修改K线</button>
    <button onclick="stopSubscribe();">添加K线</button>
    <script  src="k-data.js"></script>
</body>
</html>